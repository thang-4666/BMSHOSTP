SET DEFINE OFF;
CREATE OR REPLACE FUNCTION fn_getprinused(ACCTNO IN varchar2, CODEID_FR IN VARCHAR2)
RETURN NUMBER
IS

    PRINUSED NUMBER(20,0);

BEGIN

    SELECT SUM(PRINUSED) PRINUSED
    INTO PRINUSED
    FROM vw_afpralloc_all
    WHERE AFACCTNO = ACCTNO AND CODEID = CODEID_FR and RESTYPE = 'M'
    GROUP BY AFACCTNO, CODEID;

    RETURN PRINUSED;
EXCEPTION
   WHEN OTHERS THEN
    RETURN 0;
END;

 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
/
